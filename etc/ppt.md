---
description: 바인딩 된 인쇄 미리보기를 PPT로 변환
---

# PPT 변환

과거 WebViewer와 .Net Framework에서 OPENXML 모듈을 이용해서 WORD로 변환한 경험이 있습니다.&#x20;



웹으로 먼저 시도해보고(.NET5) 소스 가져다가 .NET Framework 용으로 추가 개발을 했었습니다.&#x20;

웹과 로컬 프로그램은 구조는 비슷하지만 클래스나 속성명들이 전부 다릅니다.&#x20;

그래서 동일한 WORD 변환을 만들때 각각 개발기간이 소요되었습니다.

물론 버그 수정도 양쪽 각각 해야 합니다.



처음 웹으로 개발할때야 로컬은 생각도 안하고, 했기 때문에 그냥 프로젝트에 참조시켜서 프로젝트 클래스 구조를 그대로 이용해 변환시켰습니다.



근데 현재는 로컬프로그램쪽에서  먼저 PPT 변환을 요구하고 있어서 처음부터 양쪽 적용한 코드를 작성하지 않으면 답이 없어질것같습니다.&#x20;



그래서 중간단계의 PPT를 만들기 위한 오브젝트를 만드는 코드를 넣어서 하나의 소스로 양쪽다 적용가능하게 처리해야 겠다고 생각했습니다.&#x20;



Blazor가 좋은점이 바로 이 DLL 재사용이 가능하다는것!



1. 중간단계는 대세인 JSON을 사용합니다.
2. 중간단계는 파일로 저장합니다.(언제든지 중간데이터 확인을 위하여)



그럼 어떻게 작성하느냐?

공식문서를 보고???  문서를 보고 개발할 수 있다면, 그건 정말 천재라고 생각됩니다.&#x20;



평범한 저는 Open Xml SDK Productivity Tool for Microsoft Office를 이용하겠습니다.&#x20;

1. 빈 PPT를 생성한다.
2. 저 툴로 파일을 연다.
3. 리플렉트를 해서 c#코드를 가져온다.
4. 빈 PPT에 텍스트 하나 입력한다.
5. 저 툴로 파일을 연다.
6. 리플렉트해서 변경된 C#코드를 가져온다.
7. 변경된 C#코드를 텍스트 만드는 함수로 변경한다.
8. 4\~7에서 항목(텍스트,  그림, 테두리, 스타일) 등을 조금씩 변경해 가며 반복한다.&#x20;
9. 완료.

별거 없습니다. 반복 노가다 작업입니다. 아무나 할 수 있습니다.&#x20;



> 텍스트를 표현하는데 테이블의 셀과 , 일반 Shape(텍스트상자)이 있습니다.&#x20;
>
> 기능상 차이점은 테이블셀은 테두리를 자유롭게 설정 가능하며, (상하좌우 각각)\
> Shape의 경우 영역을 벗어난 경우 Wrap을 사용하지 않고 글자가 튀어나오게 가능합니다. \
> 기존 레포트 툴은 저 두 기능을 합쳐 놓은거라서, PPT 변환시에 어떤 쪽의 기능을 우선시 할지 선택해야 했습니다.&#x20;

> 테이블 생성시 컬럼사이즈의 최소값이 존재. 평범한 테이블은 의미없는 값이지만, 다양한 병합이 들어갈경우 최소 컬럼사이즈보다 작을경우 PPT 실행시 자동으로 사이즈가 늘어나는 현상이 있습니다.&#x20;

> PPT의경우 빈 셀을 만들경우 스타일이 적용되지 않습니다. 공백을 입력해줘야 합니다.&#x20;

> PPT의 경우 셀 병합을 하려면 무조건 병합하려는 셀도 있어야 가능합니다.

> 분명히 셀 단위로 생성을 하니까 당연히 마지막에 생성하는 셀의 테두리가 적용될걸로 생각되는데 내부 생성로직은 전혀 그렇지 않습니다. 셀을 전부 만들고 선언된 순서에따라 각 방향의 테두리가 일괄로 적용됩니다. \
> 즉 왼쪽 다 적용되고, 위쪽적용되고, 오른쪽적용되고, 아래쪽적용되고, 일괄적용 됩니다.

> openxml?? 은 EMU 단위를 사용. px \* emu 변환계수 로 사용하면 됩니다. \
> EMU(English Metric Units) 96ppi 이미지의 변환 계수는 9525  이고, 72ppi 이미지의 경우 12700, 300ppi 이미지의 경우 3048



개발하면서 히스토리    문서작성을 목표로 했지만, 실질적으로는 불가능했습니다.&#x20;

개발 완료후 아래 깃에 사용 메뉴얼 및 소스 공유했습니다.&#x20;

[https://github.com/jyseok85/SimpleOfficeCreator.Standard.git](https://github.com/jyseok85/SimpleOfficeCreator.Standard.git)



